webpackJsonp([1],{33:function(t,i,e){e(76);var a=e(77)(e(35),e(78),null,null);t.exports=a.exports},35:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e(36),s=e(37);i.default={props:["config","callback","redirTo"],data:function(){return{step:0,overlay:!1,avatar:null,image:new s.a,dragger:new a.a(".fbc-canvas-img",[".fbc-drag-overlay"],this.onMove),fb_cropper_width:1e3,orientation_prop:1.8,canvas:{width:0,height:0},canvasImage:{width:0,height:0,top:0,left:0},cropbox:{width:0,height:0,left:0,top:0},cropboxImage:{width:0,height:0,left:0,top:0},dragging:!1,dragStartPos:[],croppedImageSrc:""}},methods:{handleImage:function(t){t.preventDefault(),this.overlay=!0,this.$emit("fileSelect");var i=t.target.files||t.dataTransfer.files,e=i[0];t.target.value=null;var a=this;if(!this.image.isImage(e))return this.$emit("error","Invalid Image"),a.overlay=!1,!1;this.image.onFileRead(e,function(){a.image.resize().fit().create(),a.canvasImage.width=a.image.width,a.canvasImage.height=a.image.height,a.step=1,a.overlay=!1,a.setOffset()})},addPx:function(t){var i={};return i.width=t.width+"px",i.height=t.height+"px",t.hasOwnProperty("top")&&(i.top=t.top+"px"),t.hasOwnProperty("left")&&(i.left=t.left+"px"),i},setOffset:function(){"mobile"===window.device&&(this.canvas.width=this.$refs.fbContainer.offsetWidth,this.canvas.height=this.canvas.width);var t=void 0,i=void 0;this.image.prop>=1?(t=this.image.width>this.cropbox.width?this.cropbox.width:this.image.width,i=t/this.image.prop):(i=this.image.height>this.cropbox.height?this.cropbox.height:this.image.height,t=i*this.image.prop),t<this.cropbox.width&&(t=this.cropbox.width,i=t/this.image.prop),i<this.cropbox.height&&(i=this.cropbox.height,t=i*this.image.prop),this.caclImageOffset(t,i)},caclImageOffset:function(t,i){var e=void 0,a=void 0;e=(this.canvas.width-t)/2,a=(this.canvas.height-i)/2,this.$refs.canvasImage.style.width=t+"px",this.$refs.canvasImage.style.height=i+"px",this.$refs.canvasImage.style.left=e+"px",this.$refs.canvasImage.style.top=a+"px",this.canvasImage={width:t,height:i,left:e,top:a},this.setCropboxImageProp()},setCanvasImageProp:function(){this.canvasImage.left=(this.canvas.width-this.canvasImage.width)/2,this.canvasImage.top=(this.canvas.height-this.canvasImage.height)/2},setCropboxImageProp:function(){var t=this.$refs.cropboxImage.style;if(t.width=this.canvasImage.width+"px",t.height=this.canvasImage.height+"px",this.cropbox.left=(this.canvas.width-this.cropbox.width)/2,this.cropbox.top=(this.canvas.height-this.cropbox.height)/2,this.image.img){var i=this.canvasImage.left-this.cropbox.left,e=this.canvasImage.top-this.cropbox.top;t.left=i+"px",t.top=e+"px",this.cropboxImage={width:parseInt(t.width),height:parseInt(t.height),top:e,left:i}}},onMove:function(t,i){var e=this.cropbox.width+this.cropbox.left-this.canvasImage.width;t=t<e?e:t,t=t>this.cropbox.left?this.cropbox.left:t,this.$refs.canvasImage.style.left=t+"px";var a=this.cropbox.height+this.cropbox.top-this.canvasImage.height;i=i<a?a:i,i=i>this.cropbox.top?this.cropbox.top:i,this.$refs.canvasImage.style.top=i+"px",this.canvasImage.left=t,this.canvasImage.top=i,this.setCropboxImageProp(t,i)},getMinValue:function(){return this.cropbox.height>this.cropbox.width?this.image.prop>1?this.cropbox.height*this.image.prop:this.cropbox.height:this.image.prop>1?this.cropbox.width*this.image.prop:this.cropbox.width},resizeImage:function(t){this.canvasImage.height=this.canvasImage.width/this.image.prop,this.caclImageOffset(this.canvasImage.width,this.canvasImage.height)},cropImage:function(t){t.preventDefault(),this.overlay=!0,self=this;var i=this.image.create({canvas_width:this.cropbox.width,canvas_height:this.cropbox.height,width:this.cropboxImage.width,height:this.cropboxImage.height,top:this.cropboxImage.top,left:this.cropboxImage.left,isCrop:!0});this.croppedImageSrc=i,this.step=2,this.overlay=!1,this.$emit("crop",i)}},computed:{selectorStyle:function(){return{width:this.config.canvas.width+"px",height:this.config.canvas.height+"px"}},canvasStyle:function(){return this.setCanvasImageProp(),this.addPx(this.canvas)},canvasImageStyle:function(){return this.addPx(this.canvasImage)},cropboxStyle:function(){return this.cropbox.left=(this.canvas.width-this.cropbox.width)/2,this.cropbox.top=(this.canvas.height-this.cropbox.height)/2,this.addPx(this.cropbox)},cropboxImageStyle:function(){return this.cropboxImage.width=this.canvasImage.width,this.cropboxImage.height=this.canvasImage.height,this.addPx(this.cropboxImage)},getStep:function(){return(this.image.width-this.getMinValue())/10},footerStyle:function(){return{width:this.config.canvas.width+"px"}}},created:function(){this.canvas.width=this.config.canvas.width,this.canvas.height=this.config.canvas.height,this.cropbox.width=this.config.cropbox.width,this.cropbox.height=this.config.cropbox.height,this.image.opt.max=this.config.maxSize||1e3,this.image.opt.min=Math.max(this.config.cropbox.width,this.config.cropbox.height)},mounted:function(){var t=this;this.setOffset(),["mousedown","mousemove","mouseup","mouseout","touchstart","touchmove","touchend"].forEach(function(i){document.querySelector(".fbc-drag-overlay").addEventListener(i,function(i){return i.preventDefault(),t.dragger[i.type](i),!1},!1)})}}},36:function(t,i,e){"use strict";var a=e(20),s=e.n(a),h=e(21),o=e.n(h),r=function(){function t(i,e,a){s()(this,t),this.el=i,this.callback=a,this.drag_elements=e,this.dragging=!1,this.startClientXY=[],this.startStyleXY=[]}return o()(t,[{key:"dragStart",value:function(t){var i=document.querySelector(this.el);this.startClientXY=[t.clientX,t.clientY],this.startStyleXY=[parseInt(i.style.left),parseInt(i.style.top)]}},{key:"onDrag",value:function(t){var i=this.startStyleXY[0]+t.clientX-this.startClientXY[0],e=this.startStyleXY[1]+t.clientY-this.startClientXY[1];return this.callback(i,e),!1}},{key:"mousedown",value:function(t){this.dragging||(this.dragging=!0,this.dragStart(t))}},{key:"mousemove",value:function(t){if(!this.dragging)return!1;this.onDrag(t)}},{key:"mouseup",value:function(t){this.dragging=!1,this.startClientXY=[]}},{key:"mouseout",value:function(t){return t.preventDefault(),this.drag_elements.indexOf(t.toElement.className)>-1?!!this.dragging&&void this.onDrag(t):(this.dragging=!1,this.drag_start={},!1)}},{key:"touchstart",value:function(t){if(!this.dragging){this.dragging=!0;var i=t.changedTouches[0];this.dragStart(i)}}},{key:"touchend",value:function(t){t.preventDefault(),this.dragging&&(this.dragging=!1,this.move_start=0,this.startClientXY=[])}},{key:"touchmove",value:function(t){if(t.preventDefault(),!this.dragging)return!1;this.onDrag(t.changedTouches[0])}}]),t}();i.a=r},37:function(t,i,e){"use strict";var a=e(40),s=e.n(a),h=e(20),o=e.n(h),r=e(21),n=e.n(r),c=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t),this.img=null,this.src=null,this.width=null,this.height=null,this.prop=1,this.opt=i}return n()(t,[{key:"isImage",value:function(t){return t.type.includes("image")}},{key:"onFileRead",value:function(t,i){this.origFileName=t.name,this.origFileSize=t.size,self=this;var e=new FileReader;e.onload=function(t){self.onLoadImage(t.target.result,i)},e.readAsDataURL(t)}},{key:"onLoadImage",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=new Image,a=this;e.onload=function(){a.img=e,a.prop=e.naturalWidth/e.naturalHeight,a.width=e.naturalWidth,a.height=e.naturalHeight,i&&i(e,a.width,a.height,a.prop)},e.src=t}},{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h=t.hasOwnProperty("img")?t.img:this.img,t.width=t.hasOwnProperty("width")?t.width:this.width,t.height=t.hasOwnProperty("height")?t.height:this.height,t.top=t.hasOwnProperty("top")?t.top:0,t.left=t.hasOwnProperty("left")?t.left:0,t.quality=t.hasOwnProperty("quality")?t.quality:.7,t.isCrop=!!t.hasOwnProperty("isCrop")&&t.isCrop;var e=document.createElement("canvas");e.width=t.hasOwnProperty("canvas_width")?t.canvas_width:t.width,e.height=t.hasOwnProperty("canvas_height")?t.canvas_height:t.height,e.getContext("2d").drawImage(h,t.left,t.top,t.width,t.height);var a=t.quality>1?t.quality/100:t.quality,s=e.toDataURL("image/jpeg",a);this.setSize(s);var h=new Image,o=this;return h.onload=function(){o.img=h,i&&i(h)},t.isCrop||(h.src=s),s}},{key:"setSize",value:function(t){var i=Math.round(3*(t.length-"data:image/jpeg;base64,".length)/4);this.size=i}},{key:"read",value:function(t){var i=this;return new s.a(function(e){i.onFileRead(t,e)})}},{key:"createPhoto",value:function(t){var i=this;return new s.a(function(e){i.onFileRead(t,function(t,a,s,h){var o=Math.max(a,s)>1e3?.5:.6;h>=1?(a=a>960?960:a,s=a/h):(s=s>960?960:s,a=s*h),i.create({width:a,height:s,img:t,quality:o},function(t){e(t)})})})}},{key:"resize",value:function(){return this.prop>=1?(this.width=this.width>this.opt.max?this.opt.max:this.width,this.height=this.width/this.prop):(this.height=this.height>this.opt.max?this.opt.max:this.height,this.width=this.height*this.prop),this}},{key:"fit",value:function(){return Math.max(this.width,this.height)<this.opt.min&&(this.prop>=1?(this.height=this.opt.min,this.width=this.height*this.prop):(this.width=this.opt.min,this.height=this.width/this.prop)),this}},{key:"fitCover",value:function(){var t=this.opt.width/this.opt.height;if(1==this.prop)this.width=this.height=this.opt.width;else if(this.prop<1)this.width=this.opt.width,this.height=this.width/this.prop;else if(this.prop>1&&this.prop<=t)this.width=this.opt.width,this.height=this.width/this.prop;else if(this.prop>t){var i=this.opt.height/this.height;this.height=this.opt.height,this.width=this.width*i}return this}},{key:"addPx",value:function(t){var i={};return i.width=t.width+"px",i.height=t.height+"px",t.hasOwnProperty("top")&&(i.top=t.top+"px"),t.hasOwnProperty("left")&&(i.left=t.left+"px"),i}}]),t}();i.a=c},38:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e(34),s=e(33),h=e.n(s);a.a.config.productionTip=!1;var o={canvas:{width:600,height:400},cropbox:{width:300,height:260},maxSize:1e3};new a.a({el:"#app",template:'<App :config="config" @crop="imageData" @error="onError" @fileSelect="onFileSelect" />',components:{App:h.a},data:{config:o},methods:{imageData:function(t){console.log(t)},onError:function(t){console.log(t)},onFileSelect:function(){console.log("file selected")}}})},76:function(t,i){},78:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{ref:"fbContainer",attrs:{id:"fbContainer"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:0===t.step,expression:"step===0"}],staticClass:"file-selector has-text-centered",style:t.selectorStyle,on:{click:function(i){t.$refs.fileinput.click()},dragleave:function(t){t.preventDefault()},dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()},drop:function(i){i.preventDefault(),t.handleImage(i)}}},[e("input",{ref:"fileinput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:t.handleImage}}),t._v(" "),e("p",{staticStyle:{color:"#999",margin:"30px 0","font-size":"1.5rem"}},[t._v("Drop image here or Click to select")]),t._v(" "),e("i",{staticClass:"fa fa-cloud-upload"})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.step,expression:"step==1"}],ref:"fbCropper",staticClass:"crop-container",style:t.canvasStyle,attrs:{id:"fb_cropper"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.image.img,expression:"image.img"}],staticClass:"fbc-canvas",style:t.canvasStyle},[e("img",{ref:"canvasImage",staticClass:"fbc-canvas-img",attrs:{src:t.image.img?t.image.img.src:""}}),t._v(" "),e("div",{staticClass:"cropbox",style:t.cropboxStyle},[e("img",{ref:"cropboxImage",staticClass:"cropbox-image",attrs:{src:t.image.img?t.image.img.src:""}})])]),t._v(" "),e("div",{staticClass:"fbc-drag-overlay"})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.step,expression:"step==1"}],staticClass:"fbc-footer",style:t.footerStyle},[e("div",{staticClass:"fbc-footer-left"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.canvasImage.width,expression:"canvasImage.width",modifiers:{number:!0}}],staticClass:"range-slider",attrs:{type:"range",min:t.getMinValue(),max:t.image.width,step:t.getStep},domProps:{value:t.canvasImage.width},on:{input:t.resizeImage,__r:function(i){t.canvasImage.width=t._n(i.target.value)},blur:function(i){t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"fbc-footer-right"},[e("button",{staticClass:"btn-crop",on:{click:t.cropImage}},[e("span",[t._v("Crop")])])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2==t.step,expression:"step==2"}],staticClass:"crop-container",style:t.canvasStyle},[e("div",{staticClass:"fbc-output",style:t.canvasStyle},[e("img",{attrs:{src:t.croppedImageSrc,alt:""}})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.overlay,expression:"overlay"}],staticClass:"fbc-overlay"},[e("i",{staticClass:"fbc-loader is-small"})])])},staticRenderFns:[]}}},[38]);
//# sourceMappingURL=app.f7107e1dcdd087647298.js.map